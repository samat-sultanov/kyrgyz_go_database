{% extends 'base.html' %}
{% load static %}

{% block nav %}
{% endblock %}

{% block content %}
    <div class="container mb-4 mt-4">
        <div>
            <h2 class="title">Tournament: {{ tournament.name }}</h2>
                <p>Date: {{ tournament.date }}</p>
                <p>City: {{ tournament.city }}</p>
                <p>Number of participants: {{ tournament.player_set.count }}</p>
                <p>Rounds: {{ tournament.rounds }}</p>
                <p>Board size: {{ tournament.board_size }}</p>
                <p>Class: {{ tournament.tournament_class }}</p>
        </div>
    </div>
    <div class="container">
    <table class="table">
    <thead>
    <tr>
        <th scope="col"></th>
      <th scope="col">Фамилия</th>
      <th scope="col">Имя</th>
      <th scope="col">Отчество</th>
      <th scope="col">Возраст</th>
      <th scope="col">Клуб</th>
      <th scope="col">Rank</th>
      <th scope="col">Wins</th>
      <th scope="col">Losses</th>
    </tr>
    </thead>
    <tbody>
    {% for player in players %}
    <tr>
        <td>{{ forloop.counter }}</td>
        <td><a style="text-decoration: underline dotted ghostwhite; color: black;" href="{% url "webapp:player_detail" player.pk %}">{{ player.last_name }}</a></td>
        <td>{{ player.first_name }}</td>
        {% if player.patronymic is not None %}
            <td>{{ player.patronymic }}</td>
        {% else %}
            <td></td>
        {% endif %}
        {% if player.age is not None %}
            <td>{{ player.age }}</td>
        {% else %}
            <td></td>
        {% endif %}
        {% if player.clubs.all  %}
            {% for club in player.clubs.all %}
                <td>{{ club.name }}</td>
            {% endfor %}
        {% else %}
            <td>Не состоит в клубах</td>
        {% endif %}

        {% for rate in player.playerintournament_set.all %}
            {% if tournament.id == rate.tournament_id %}
            <td>{{ rate.GoLevel }}</td>
            {% endif %}
        {% endfor %}
        {% for winner in wins %}
            {% if player.pk == winner.player%}
            <td>{{ winner.wins}}</td>
            <td>{{ winner.losses}}</td>
            {% endif %}
        {% endfor %}
        </tr>
    {% endfor %}
    </tbody>
</table>

    </div>
{% endblock %}